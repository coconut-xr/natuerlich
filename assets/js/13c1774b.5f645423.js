"use strict";(self.webpackChunknatuerlich_docs=self.webpackChunknatuerlich_docs||[]).push([[949],{3568:(e,n,t)=>{t.r(n),t.d(n,{assets:()=>u,contentTitle:()=>p,default:()=>h,frontMatter:()=>r,metadata:()=>d,toc:()=>c});var o=t(7462),a=(t(7294),t(3905)),s=t(5851),i=t(1361);const r={},p="Poses",d={unversionedId:"poses",id:"poses",title:"Poses",description:"Our implementation is based on handy-work",source:"@site/docs/poses.md",sourceDirName:".",slug:"/poses",permalink:"/natuerlich/poses",draft:!1,tags:[],version:"current",frontMatter:{},sidebar:"mainSidebar",previous:{title:"Tracked Planes",permalink:"/natuerlich/tracked-planes"},next:{title:"Teleport",permalink:"/natuerlich/teleport"}},u={},c=[],l={toc:c},m="wrapper";function h(e){let{components:n,...r}=e;return(0,a.kt)(m,(0,o.Z)({},l,r,{components:n,mdxType:"MDXLayout"}),(0,a.kt)("h1",{id:"poses"},"Poses"),(0,a.kt)("admonition",{type:"info"},(0,a.kt)("mdxAdmonitionTitle",{parentName:"admonition"},(0,a.kt)("strong",{parentName:"mdxAdmonitionTitle"},"Acknowledgement")),(0,a.kt)("p",{parentName:"admonition"},"Our implementation is based on ",(0,a.kt)("a",{parentName:"p",href:"https://github.com/AdaRoseCannon/handy-work"},"handy-work"))),(0,a.kt)("p",null,"For detecting hand poses, ",(0,a.kt)("strong",{parentName:"p"},"natuerlich")," offers the ",(0,a.kt)("inlineCode",{parentName:"p"},"useHandPoses")," hook. The hook takes the ",(0,a.kt)("inlineCode",{parentName:"p"},"inputSource.hand"),", the ",(0,a.kt)("inlineCode",{parentName:"p"},"inputSource.handedness"),", and a callback called every frame with the current and previous detected pose. The callback is followed by the poses that the algorithm should detect. The parameter maps the URL where the pose information can be found to its name. The last parameter of the hook is optional and contains the ",(0,a.kt)("inlineCode",{parentName:"p"},"baseUrl")," for the URLs of the poses."),(0,a.kt)("p",null,(0,a.kt)("strong",{parentName:"p"},"natuerlich")," provides the default poses ",(0,a.kt)("inlineCode",{parentName:"p"},"fist, flat, horns, l, peace, point, relax, shaka, and thumb"),"."),(0,a.kt)("p",null,"The ",(0,a.kt)("inlineCode",{parentName:"p"},"useHandPoses")," hook returns a function that allows downloading the current hand pose to a binary file. This file can then be used to match the recorded pose. New poses can be captured using your own implementation or directly inside the ",(0,a.kt)("a",{parentName:"p",href:"https://github.com/coconut-xr/pose-booth"},"coconut-xr/pose-booth"),"."),(0,a.kt)("p",null,"The following code illustrates how to use the ",(0,a.kt)("inlineCode",{parentName:"p"},"useHandPoses")," hook. The example displays the currently and previously detected pose on a Koestlich UI. A ",(0,a.kt)("inlineCode",{parentName:"p"},"PoseHand")," component is created and used for each present ",(0,a.kt)("inlineCode",{parentName:"p"},"inputSource")," that contains ",(0,a.kt)("inlineCode",{parentName:"p"},"inputSource.hand"),". For more information about mapping ",(0,a.kt)("inlineCode",{parentName:"p"},"inputSources")," to hands/controllers visit the ",(0,a.kt)("a",{parentName:"p",href:"/natuerlich/input-sources"},"Input Sources")," documentation."),(0,a.kt)("p",null,"Another example of using the ",(0,a.kt)("inlineCode",{parentName:"p"},"useHandPoses")," hook inside a custom hand to detect a fist gesture and trigger a grab interaction in the scene can be found in the ",(0,a.kt)("a",{parentName:"p",href:"/natuerlich/custom-input-sources"},"Custom Input")," documentation."),(0,a.kt)("admonition",{title:"Important",type:"caution"},(0,a.kt)("p",{parentName:"admonition"},"The downloaded pose corresponds to the ",(0,a.kt)("inlineCode",{parentName:"p"},"inputSource.hand")," pose. Calling ",(0,a.kt)("inlineCode",{parentName:"p"},"downloadPose")," on both hands records one pose for each hand. The recording of a pose is unrelated to the right or left hand. A pose recorded on the left-hand works on the right hand and vice versa.")),(0,a.kt)(i.w,{path:"natuerlich-poses-nwf4s9",mdxType:"CodesandboxEmbed"}),(0,a.kt)(s.Z,{img:t(7412),mdxType:"Image"}),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-tsx"},'import { XRCanvas } from "@coconut-xr/natuerlich/defaults";\nimport { getInputSourceId } from "@coconut-xr/natuerlich";\nimport { useState } from "react";\nimport {\n  useEnterXR,\n  NonImmersiveCamera,\n  ImmersiveSessionOrigin,\n  useInputSources,\n  useHandPoses\n} from "@coconut-xr/natuerlich/react";\nimport { RootContainer, Text } from "@coconut-xr/koestlich";\n\nconst sessionOptions: XRSessionInit = {\n  requiredFeatures: ["local-floor", "hand-tracking"]\n};\n\nexport function PoseHand({\n  hand,\n  inputSource,\n  setPoseNames\n}: {\n  hand: XRHand;\n  inputSource: XRInputSource;\n  setPoseNames: (names: string) => void;\n}) {\n  useHandPoses(\n    hand,\n    inputSource.handedness,\n    (name, prevName) => {\n      console.log(name, prevName);\n      setPoseNames(`${name}, ${prevName}`);\n    },\n    {\n      fist: "fist.handpose",\n      relax: "relax.handpose",\n      point: "point.handpose"\n    }\n  );\n\n  return null;\n}\n\nexport default function Index() {\n  const enterAR = useEnterXR("immersive-ar", sessionOptions);\n  const inputSources = useInputSources();\n  const [leftPoseNames, setLeftPoseNames] = useState("none");\n  const [rightPoseNames, setRightPoseNames] = useState("none");\n  return (\n    <div\n      style={{...}}\n    >\n      <button onClick={enterAR}>Enter AR</button>\n      <XRCanvas>\n        <group position={[0, 1.5, 0]}>\n          <RootContainer anchorX="center" anchorY="center">\n            <Text>{`Left: ${leftPoseNames}`}</Text>\n            <Text>{`Right: ${rightPoseNames}`}</Text>\n          </RootContainer>\n        </group>\n        <NonImmersiveCamera position={[0, 1.5, 4]} />\n        <ImmersiveSessionOrigin position={[0, 0, 4]}>\n          {inputSources.map((inputSource) =>\n            inputSource.hand != null ? (\n              <PoseHand\n                setPoseNames={\n                  inputSource.handedness === "left"\n                    ? setLeftPoseNames\n                    : setRightPoseNames\n                }\n                key={getInputSourceId(inputSource)}\n                inputSource={inputSource}\n                hand={inputSource.hand}\n              />\n            ) : null\n          )}\n        </ImmersiveSessionOrigin>\n      </XRCanvas>\n    </div>\n  );\n}\n\n')),(0,a.kt)("admonition",{type:"tip"},(0,a.kt)("p",{parentName:"admonition"},"If the goal is to detect pose changes, the following code illustrates how to detect the start and end of the ",(0,a.kt)("inlineCode",{parentName:"p"},"fist")," pose.")),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-typescript"},'const isFist = name === "fist";\nconst wasFist = prevName === "fist";\nif (isFist == wasFist) {\n  return;\n}\nif (isFist) {\n  //fist pose started\n}\nif (wasFist) {\n  //fist pose stopped\n}\n')),(0,a.kt)("hr",null),(0,a.kt)("admonition",{title:"Question not answered?",type:"note"},(0,a.kt)("p",{parentName:"admonition"},"If your questions were not yet answered, visit our ",(0,a.kt)("a",{parentName:"p",href:"https://discord.gg/NCYM8ujndE"},"Discord")," \ud83d\ude09")))}h.isMDXComponent=!0},7412:(e,n,t)=>{t.r(n),t.d(n,{default:()=>o});const o=t.p+"assets/images/poses-6429c036827ddfc55c38a949cffdd49f.gif"}}]);